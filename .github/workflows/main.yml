name: marp-github-actions
on: [push]
jobs:
  marp-to-pdf:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: sudo apt-get update & sudo apt-get install jq
      - run: |
          directory=$(cat config.json | jq .directory)
          output_format=$(cat config.json | jq .output_format)
      - run: |
          docker run --rm -u root --init \
            -v $PWD:/home/marp/app/ \
            -e LANG=$LANG marpteam/marp-cli flutter/slide.md --${output_format}
            -o ${directory}.${output_format}
      - uses: actions/upload-artifact@v2
        with:
          name: output_slide
          path: ${directory}.${output_format}
